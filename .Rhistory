da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc.n2o <- dc[! is.na(start.N2O), ]
dc.ch4 <- dc[! is.na(start.CH4), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , Datatime := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"))]
View(dc.n2o)
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Static-Chambers-Aeris-Data")
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# clear workspace
rm(list = ls())
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# clear workspace
rm(list = ls())
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
View(dc)
# splitting dc in two data.tables, one for N2O and one for CH4
dc.n2o <- dc[! is.na(start.N2O), ]
dc.ch4 <- dc[! is.na(start.CH4), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , Datatime := Datatime + 1 * 3600]
View(dc.n2o)
View(dc.ch4)
View(dc.ch4)
dc.n2o <- dc[! is.character(start.N2O), ]
dc.n2o <- dc[! is.na(start.N2O), ]
class(dc.n2o$start.N2O)
dc.n2o <- dc[! is.na(start.N2O), ]
dc.n2o <- dc[! is.charatcter(start.N2O), ]
dc.n2o <- dc[! is.character(start.N2O), ]
dc.n2o <- dc[! is.na(start.N2O), ]
dc.n2o <- dc[is.na(start.N2O), ]
dc.n2o <- dc[is.na(start.CH4), ]
dc$start.N2O <- is.numeric(dc$start.N2O)
dc$end.N2O <- is.numeric(dc$end.N2O)
dc.n2o <- dc[! is.na(start.N2O), ]
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
dc$start.N2O <- is.numeric(dc$start.N2O)
dc$end.N2O <- is.numeric(dc$end.N2O)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc.n2o <- dc[! is.na(start.N2O), ]
dc <- dc[! is.na(start.N2O), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , Datatime := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"))]
View(da)
class(da$date.time)
class(dc$end.time)
class(dc$date.time)
dc$date.time <- dc$start.time
class(dc$date.time)
dc$date.time <- as.POSIXct(dc$start.time)
dc$date.time <- as.POSIXct(dc$start.time, form = '%YY-%MM-%dd %HH:%MM')
class(dc$date.time)
dc$date.time <- as.POSIXct(dc$start.time, form = '%dd-%MM-%YY %HH:%MM')
class(dc$date.time)
dc$date.time <- as.POSIXct(dc$start.time, form = '%dd-%MM-%YY %hh:%mm')
dc[, date.time := as.POSIXct(start.time, format = "%d-%m-%Y %H:%M")]
dc[, date.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M")]
da$date.time
da$date.time[1:5]
dc$date.time[1:5]
# clear workspace
rm(list = ls())
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# I removed this as this path only works on your (Lorenzos) computer.
# setwd("~/Desktop/Università/DiANA/Dottorato/Danimarca/AU/Aeris GHG Graes")
# General recommendations:
# have separate scripts for N2O and CH4 data.
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc <- dc[! is.na(start.N2O), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , Datatime := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"))]
# change dc begin time to same format as date.time in da
dc[, begin.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M")]
dc[, end.time := as.POSIXct(end.time, format = "%d-%m-%Y %H:%M")]
# clear workspace
rm(list = ls())
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# I removed this as this path only works on your (Lorenzos) computer.
# setwd("~/Desktop/Università/DiANA/Dottorato/Danimarca/AU/Aeris GHG Graes")
# General recommendations:
# have separate scripts for N2O and CH4 data.
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc <- dc[! is.na(start.N2O), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , Datatime := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"))]
# change dc begin time to same format as date.time in da
dc[, begin.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M")]
dc[, final.time := as.POSIXct(final.time, format = "%d-%m-%Y %H:%M")]
# clear workspace
rm(list = ls())
# clear workspace
rm(list = ls())
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# I removed this as this path only works on your (Lorenzos) computer.
# setwd("~/Desktop/Università/DiANA/Dottorato/Danimarca/AU/Aeris GHG Graes")
# General recommendations:
# have separate scripts for N2O and CH4 data.
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc <- dc[! is.na(start.N2O), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , Datatime := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
# da[, date.time := as.POSIXct(round(Datatime, "mins"))]
# change dc begin time to same format as date.time in da
dc[, begin.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M")]
dc[, final.time := as.POSIXct(final.time, format = "%d-%m-%Y %H:%M")]
da[, date.time.end := date.time]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , date.time := Datatime + 1 * 3600]
da[, date.time.end := date.time]
setkey(dc, begin.time, final.time)
setkey(da, date.time, date.time.end)
# Perform interval overlap join
result <- foverlaps(da, dc, by.x = c("date.time", "date.time.end"),
by.y = c("begin.time", "final.time"),
nomatch = 0L)
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"))]
da[, date.time.end := date.time]
setkey(dc, begin.time, final.time)
setkey(da, date.time, date.time.end)
# Perform interval overlap join
result <- foverlaps(da, dc, by.x = c("date.time", "date.time.end"),
by.y = c("begin.time", "final.time"),
nomatch = 0L)
# clear workspace
rm(list = ls())
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# I removed this as this path only works on your (Lorenzos) computer.
# setwd("~/Desktop/Università/DiANA/Dottorato/Danimarca/AU/Aeris GHG Graes")
# General recommendations:
# have separate scripts for N2O and CH4 data.
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc <- dc[! is.na(start.N2O), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , date.time := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"))]
# change dc begin time to same format as date.time in da
dc[, begin.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M")]
dc[, final.time := as.POSIXct(final.time, format = "%d-%m-%Y %H:%M")]
da[, date.time.end := date.time]
setkey(dc, begin.time, final.time)
setkey(da, date.time, date.time.end)
# Perform interval overlap join
result <- foverlaps(da, dc, by.x = c("date.time", "date.time.end"),
by.y = c("begin.time", "final.time"),
nomatch = 0L)
dc[begin.time > final.time]
dc[begin.time > final.time, c("begin.time", "final.time") := .(final.time, begin.time)]
dc[begin.time > final.time]
# Perform interval overlap join
result <- foverlaps(da, dc, by.x = c("date.time", "date.time.end"),
by.y = c("begin.time", "final.time"),
nomatch = 0L)
# clear workspace
rm(list = ls())
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# I removed this as this path only works on your (Lorenzos) computer.
# setwd("~/Desktop/Università/DiANA/Dottorato/Danimarca/AU/Aeris GHG Graes")
# General recommendations:
# have separate scripts for N2O and CH4 data.
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc <- dc[! is.na(start.N2O), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , date.time := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"))]
# change dc begin time to same format as date.time in da
dc[, begin.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M")]
dc[, final.time := as.POSIXct(final.time, format = "%d-%m-%Y %H:%M")]
da[, date.time.end := date.time]
setkey(dc, begin.time, final.time)
setkey(da, date.time, date.time.end)
dc[begin.time > final.time, c("begin.time", "final.time") := .(final.time, begin.time)]
dc[begin.time > final.time]
# Perform interval overlap join
result <- foverlaps(da, dc, by.x = c("date.time", "date.time.end"),
by.y = c("begin.time", "final.time"),
nomatch = 0L)
# clear workspace
rm(list = ls())
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# I removed this as this path only works on your (Lorenzos) computer.
# setwd("~/Desktop/Università/DiANA/Dottorato/Danimarca/AU/Aeris GHG Graes")
# General recommendations:
# have separate scripts for N2O and CH4 data.
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc <- dc[! is.na(start.N2O), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , date.time := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"))]
# change dc begin time to same format as date.time in da
dc[, begin.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M")]
dc[, final.time := as.POSIXct(final.time, format = "%d-%m-%Y %H:%M")]
da[, date.time.end := date.time]
dc[begin.time > final.time, c("begin.time", "final.time") := .(final.time, begin.time)]
dc[begin.time > final.time]
setkey(dc, begin.time, final.time)
setkey(da, date.time, date.time.end)
# Perform interval overlap join
result <- foverlaps(da, dc, by.x = c("date.time", "date.time.end"),
by.y = c("begin.time", "final.time"),
nomatch = 0L)
# change dc begin time to same format as date.time in da
dc[, begin.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
dc[, final.time := as.POSIXct(final.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
# clear workspace
rm(list = ls())
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# I removed this as this path only works on your (Lorenzos) computer.
# setwd("~/Desktop/Università/DiANA/Dottorato/Danimarca/AU/Aeris GHG Graes")
# General recommendations:
# have separate scripts for N2O and CH4 data.
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc <- dc[! is.na(start.N2O), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , date.time := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"))]
# change dc begin time to same format as date.time in da
dc[, begin.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
dc[, final.time := as.POSIXct(final.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
da[, date.time.end := date.time]
dc[begin.time > final.time, c("begin.time", "final.time") := .(final.time, begin.time)]
dc[begin.time > final.time]
setkey(dc, begin.time, final.time)
setkey(da, date.time, date.time.end)
# Perform interval overlap join
result <- foverlaps(da, dc, by.x = c("date.time", "date.time.end"),
by.y = c("begin.time", "final.time"),
nomatch = 0L)
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins", , tzone = 'UTC'))]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"), tzone = 'UTC')]
# clear workspace
rm(list = ls())
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# I removed this as this path only works on your (Lorenzos) computer.
# setwd("~/Desktop/Università/DiANA/Dottorato/Danimarca/AU/Aeris GHG Graes")
# General recommendations:
# have separate scripts for N2O and CH4 data.
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc <- dc[! is.na(start.N2O), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , date.time := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"), tzone = 'UTC')]
# change dc begin time to same format as date.time in da
dc[, begin.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
dc[, final.time := as.POSIXct(final.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
da[, date.time.end := date.time]
dc[begin.time > final.time, c("begin.time", "final.time") := .(final.time, begin.time)]
dc[begin.time > final.time]
setkey(dc, begin.time, final.time)
setkey(da, date.time, date.time.end)
# Perform interval overlap join
result <- foverlaps(da, dc, by.x = c("date.time", "date.time.end"),
by.y = c("begin.time", "final.time"),
nomatch = 0L)
??foverlaps
1-(8/10.3)
1-(10.3/8)
setwd("C:/Users/au583430/OneDrive - Aarhus universitet/Documents/GitHub/Static-Chambers-Aeris-Data")
# clear workspace
rm(list = ls())
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# I removed this as this path only works on your (Lorenzos) computer.
# setwd("~/Desktop/Università/DiANA/Dottorato/Danimarca/AU/Aeris GHG Graes")
# General recommendations:
# have separate scripts for N2O and CH4 data.
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc <- dc[! is.na(start.N2O), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , date.time := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"), tzone = 'UTC')]
# change dc begin time to same format as date.time in da
dc[, date.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
dc[, final.time := as.POSIXct(final.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
merged <- merge(da, dc, by = "elapsed.time", all = FALSE)
View(da)
merged <- merge(da, dc, by = "date.time", all = FALSE)
View(merged)
merged <- merge(da, dc, by = "date.time", all = all.y)
??mearge
merged <- merge(da, dc, by = "date.time", all.y = TRUE)
merged <- merge(da, dc, by = "date.time", all.x = TRUE)
View(merged)
# clear workspace
rm(list = ls())
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# I removed this as this path only works on your (Lorenzos) computer.
# setwd("~/Desktop/Università/DiANA/Dottorato/Danimarca/AU/Aeris GHG Graes")
# General recommendations:
# have separate scripts for N2O and CH4 data.
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc <- dc[! is.na(start.N2O), ]
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , date.time := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, date.time := as.POSIXct(round(Datatime, "mins"), tzone = 'UTC')]
# change dc begin time to same format as date.time in da
dc[, date.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
dc[, final.time := as.POSIXct(final.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
# da[, date.time.end := date.time]
#
# dc[begin.time > final.time, c("begin.time", "final.time") := .(final.time, begin.time)]
# dc[begin.time > final.time]
#
#
# setkey(dc, begin.time, final.time)
# setkey(da, date.time, date.time.end)
merged <- merge(da, dc, by = "date.time", all.x = TRUE)
View(merged)
# clear workspace
rm(list = ls())
library(readxl)
library(dplyr)
library(lubridate)
library(writexl)
library(data.table)
# I removed this as this path only works on your (Lorenzos) computer.
# setwd("~/Desktop/Università/DiANA/Dottorato/Danimarca/AU/Aeris GHG Graes")
# General recommendations:
# have separate scripts for N2O and CH4 data.
aeris <- read_excel("Excel Aeris.xlsx")
da <- as.data.table(aeris)
dc <- fread("chamber_data_complete.csv")
setnames(dc, as.character(dc[1, ]))
dc <- dc[-1, ]
# splitting dc in two data.tables, one for N2O and one for CH4
dc$start.N2O <- as.numeric(dc$start.N2O)
dc$end.N2O <- as.numeric(dc$end.N2O)
dc <- dc[! is.na(start.N2O), ]
# Lorenzo, I am unsure if the data there is in the dc is Aeries time or 'real time'?
# if it is Aeris time then the next line correting the time should not be done
# here, but you should correct time time after mearging and before including
# temperature data.
# correcting Aeris time
# N2O aeris is 1 hour behind real time
da[ , date.time := Datatime + 1 * 3600]
# making a date.time column for mearing, rounded to nearest minute
da[, begin.time := as.POSIXct(round(Datatime, "mins"), tzone = 'UTC')]
da[, final.time := as.POSIXct(round(Datatime, "mins"), tzone = 'UTC')]
# change dc begin time to same format as date.time in da
dc[, begin.time := as.POSIXct(begin.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
dc[, final.time := as.POSIXct(final.time, format = "%d-%m-%Y %H:%M", tzone = 'UTC')]
dt <- merge(da, dc, by = "begin.time", all.x = TRUE)
dt <- merge(dt, dc, by = "final.time", all.x = TRUE)
View(dt)
